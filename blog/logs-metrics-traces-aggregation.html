<!DOCTYPE html>
<html>
    <head>
    <meta http-equiv="content-language" content="en">
    <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Logs, metrics and traces are equally useless</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="The key monitoring a distributed system is not logs, metrics or traces but how you are able to aggregate them. You can not observe and monitor a complex system looking at single signals.">
    <meta name="keywords" content="devops, observability, opentracing, tracing, distributed system, monitoring, logs, cloud, tracing">
    <meta name="google-site-verification" content="FoOIQ005srOjHlH19pNWapHvlOOVgCqHsz47IfQ6QNo" />
    <link rel="canonical" href="https://gianarb.it/blog/logs-metrics-traces-aggregation">
    <link rel="icon" type="image/png" href="/img/favicon.png" />

    <meta property="twitter:account_id" content="129952408" />
    <meta name='twitter:title' content="Logs, metrics and traces are equally useless" />
    <meta name='twitter:description' content="The key monitoring a distributed system is not logs, metrics or traces but how you are able to aggregate them. You can not observe and monitor a complex system looking at single signals." />
    <meta name="twitter:url" content="https://gianarb.it/blog/logs-metrics-traces-aggregation" />
    <meta name="twitter:creator" content="@gianarb">
    <meta name="twitter:domain" content="gianarb.it">

    <meta property="og:title" content="Logs, metrics and traces are equally useless" />
    <meta property="og:site_name" content="gianarb blog"/>
    <meta property="og:url" content="https://gianarb.it/blog/logs-metrics-traces-aggregation" />
    <meta property="og:description" content="The key monitoring a distributed system is not logs, metrics or traces but how you are able to aggregate them. You can not observe and monitor a complex system looking at single signals." />
    <meta property="og:type" content="article" />
    <meta property="og:locale" content="en_US" />


    <meta name="twitter:card" content="summary" />
    <meta property="og:image" content="https://gianarb.it/img/dna.jpg" />
    <meta name='twitter:image' content="https://gianarb.it/img/dna.jpg" />


    <link rel='alternate' type='application/atom+xml' title='Atom 0.3' href='/atom.xml'>

    <!-- source https://github.com/rsms/inter/ -->
    <link href="/fonts/inter/inter-ui.css" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/main.css">

</head>

    <body>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
        <div class="navbar-brand" href="/">
            <a href="/" class="nav-link"><img src="/img/favicon.png" class="img-fluid d-inline-block align-top" alt=""></a>
        </div>

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
            <ul class="navbar-nav ml-auto">
                <li><a class="nav-link" href="/">Home</a></li>
                <li><a class="nav-link" href="/blog.html">Blog</a></li>
                <li class="nav-item"><a href="/conferences.html" class="nav-link">Conferences</a></li>
            </ul>

            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CE7DLK7L&placement=gianarbit" id="_carbonads_js"></script>
                </li>
            </ul>

        </div> <!-- collapse -->

    </div> <!-- container fluild -->
</nav>

        

<div class="container">

    <div class="content">

        <div class="row">
            <div id="post-title" class="mt-5 col-md-12">
                <h1>Logs, metrics and traces are equally useless</h1>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <p class="meta">18 Jun 2018 · <!-- thanks to https://www.davidputney.com/2016/07/how-medium-style-read-time-estimate.html -->


<span class="blog-read-time">Two minute read</span>
 · devops, observability, opentracing, tracing, distributed system, monitoring, logs, cloud, tracing</p>
            </div>
        </div>

        <div class="row mt-3">
            <div class="col-md-12">
            <p>Every signal from applications or infrastructure is useless, in the distributed
system era aggregation matters.</p>

<p>The ability to combine logs, metrics and, traces together is the key takeaway
here.</p>

<p>Kubernetes spin ups too many containers to allow us to stream or tail a log
fail.</p>

<p>Even cloud providers offer too many virtual machines to enable us to tail
logs.</p>

<p>A centralized place where to store all of them is a great start, but you
need to experience and learn how to combine the metrics you are ingesting to
increase the visibility over your system.</p>

<p>If you instrument your code with
opentracing, for example, you can get the <code class="highlighter-rouge">trace_id</code> and attach it to your log
to associate it with the trace itself. It can also work as the lookup key for
troubleshooting.</p>

<p>If you get some weird logs, you will know from where it comes.
With opentracing, this is still a bit of a mess the specification recently
<a href="https://github.com/opentracing/specification/blob/master/rfc/trace_identifiers.md">added explicit support to extract TraceId and SpanId from the
SpanContext</a>.
It is currently not implemented in a lot of implementation. I recently started a
conversation in the
<a href="https://github.com/opentracing/opentracing-go/issues/188">opentracing-go</a>
project to figure out how to apply it because currently it depends from what
tracer you are using and it is an essential regression for the specification
itself that should hide it by design.</p>

<p>Using Jaeger this is the way to do it:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if sc, ok := span.Context().(jaeger.SpanContext); ok {
  sc.TraceID()
}
</code></pre></div></div>
<p>Using Zipkin:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>zipkinSpan, ok := sp.Context().(zipkin.SpanContext)
if ok == true &amp;&amp; zipkinSpan.TraceID.Empty() == false {
  w.Header().Add("X-Trace-ID", zipkinSpan.TraceID.ToHex())
}
</code></pre></div></div>

<p>To get back in track, I wrote this article because I saw this problem and this
inclination speaking with friends, colleagues and other devs, we are now good
(or just better) storing high cardinality values but save them inside a database
doesn’t give us any value it is all about how we use them.</p>

<p>Correlation brings your alert to a different level. You probably have an alarm
to measure how much disks you still have.</p>

<p>An alert on the only CPU usage can be very frustrated
even more if it happens too often and a lot of time you restart a container or a
node to make it work because at 2 am you can’t fix the cause. You can
investigate what matters to fill an issue on GitHub.</p>

<p>Every automation tools can make your work leaving you free to sleep. It can
probably fill out the issue.</p>

<p>Combining the CPU with the time for the system to recover from a node restart
can make your alert smart enough to wake you up when it is not able to fix
itself leaving you ready for more acute and trivial problems.</p>

<h2 id="conclusion">Conclusion</h2>
<p>It is a pretty straightforward concept, but yes, everything is useless if you
store data without getting values out of them doesn’t matter if they are logs,
metrics or traces.  The real value is not in a single one of them, it is in how
do you aggregate them together because a complex simple doesn’t explain itself
    over one signal.</p>

            </div>
        </div>

    </div>
</div>

        <div class="footer text-center bg-dark text-light">
    <div class="container">
        <div class="row">
            <div class="col-md-12 small">
                last update July 12, 2021 ·
                <a href="https://twitter.com/gianarb" target="_blank">twitter.com/gianarb</a> ·
                <a href="https://github.com/gianarb" target="_blank">github.com/gianarb</a> ·
                <a href="/atom.xml">Atom</a>
            </div>
        </div>
    </div>
</div>

    </body>
</html>
